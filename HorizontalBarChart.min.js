var graphHeight,graphWidth,Id;var widthOfRect,toolTipYPosition,chartColor=[];class HorizontalBarChart{constructor(input){this.id=input.id;this.height=input.height||200;this.width=input.width||300;this.data=input.data;this.chartColor=input.chartColor||"blue";this.margin={"Left":40,"Right":20,"Top":20,"Bottom":20};if(input.margin!=undefined){this.margin.Left=input.margin.Left||20;this.margin.Right=input.margin.Right||20;this.margin.Top=input.margin.Top||20;this.margin.Bottom=input.margin.Bottom||20}
this.animationDelay=input.animationDelay||500;this.toolTipYPosition=input.toolTipYPosition||40;this.xAxisTicks=input.yAxisTicks||5}
createHorizontalBarChart()
{Id=this.id;graphHeight=this.height-this.margin.Top-this.margin.Bottom;graphWidth=this.width-this.margin.Left-this.margin.Right;toolTipYPosition=this.toolTipYPosition;chartColor=this.chartColor;var svg=d3.select('#'+this.id).append('svg').attr('height',this.height).attr('width',this.width);var g=svg.append('g').attr('transform','translate('+this.margin.Left+','+this.margin.Top+')');var yscale=d3.scaleBand().rangeRound([graphHeight,0]).padding(0.1),xscale=d3.scaleLinear().rangeRound([0,graphWidth]);var xAxisValues=[],yAxisValues=[];for(var i=0;i<data.length;i++){xAxisValues[i]=data[i].xAxisValue;yAxisValues[i]=data[i].yAxisValue}
yscale.domain(yAxisValues);xscale.domain([0,d3.max(xAxisValues)]);g.append("g").attr("class","axis axis--x").attr("transform","translate(0,"+graphHeight+")").call(d3.axisBottom(xscale).ticks(xAxisTicks));g.append("g").attr("class","axis axis--y").call(d3.axisLeft(yscale));var divDetails=d3.select("#"+Id).append("div").attr("class","details").style("opacity",0);g.selectAll('.bar').data(data).enter().append("rect").attr("class","bar").attr("fill",function(d,i){if(chartColor!=undefined&&chartColor[i]!=null){return chartColor[i]}
else{return chartColor}}).attr("x",1).attr("y",graphHeight).attr("height",yscale.bandwidth()).attr("width",0).transition().duration(this.animationDelay).delay(function(d,i){return i*50}).attr("y",function(d){return(yscale(d.yAxisValue))}).attr("width",function(d){return xscale(d.xAxisValue)});d3.selectAll(".bar").on("mouseover",function(d){divDetails.transition().duration(200).style("opacity",1);divDetails.html(d.xAxisValue+"<br/>"+d.yAxisValue);divDetails.style("left",((xscale(d.xAxisValue)/2)+margin.Left)+"px").style("top",(yscale(d.yAxisValue)-yscale.bandwidth())+"px")}).on("mouseout",function(d){divDetails.transition().duration(500).style("opacity",0)});var axisLines=d3.selectAll(".axis--x .tick line").attr("y2",(-1*graphHeight)+'px');widthOfRect=d3.select('.bar').attr('width');var div=d3.select("#"+Id).append("div").attr("class","tooltip").style("opacity",0);var axistext=d3.selectAll(".axis--y .tick text").each(function(d,i){d3.select(this).text(dotme(d3.select(this),data[i].yAxisValue));d3.select(this).on("mouseover",function(d){div.transition().duration(200).style("opacity",1);div.html(data[i].yAxisValue).style("left",(d3.event.pageX)+"px").style("top",(d3.event.pageY)+"px")}).on("mouseout",function(d){div.transition().duration(500).style("opacity",0)})});var axisLines=d3.selectAll(".axis--x .tick line").attr("y2",(-1*graphHeight)+"px")}}
function dotme(d3Node,text){var tempText=text;if(d3Node.node().getComputedTextLength()>(margin.Left-10)){tempText=text+"...";d3Node.text(tempText);while(d3Node.node().getComputedTextLength()>(margin.Left-10)){tempText=tempText.slice(0,tempText.length-4)+tempText.slice(tempText.length-3,tempText.length);d3Node.text(tempText)}}
return tempText}